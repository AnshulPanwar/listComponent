@import './../../styles/foundation/typography/variables';
@import './../../styles/foundation/theme/kmx-theme';

@mixin _kmx-search-form__submit-button--not-disabled() {
    background-color: $kmx-yellow-500;
    border-color: $kmx-yellow-500;

    .svg-icon {
        color: $kmx-blue-500;
    }

    &:focus,
    &:hover:not(:disabled):not(:active) {
        background-color: $kmx-yellow-300;
        border-color: $kmx-yellow-300;
    }

    &:active {
        background-color: $kmx-button-primary-active-color;
        border-color: $kmx-button-primary-active-color;
    }
}

.kmx-search-form {
    &__container {
        align-items: center;
        background-color: $white;
        border-radius: size('xxs');
        display: flex;

        &:hover {
            @include kmx-elevation('1');
        }

        &--focused {
            @include kmx-elevation('1');

            .kmx-search-form__search-input,
            .kmx-search-form__clear-button {
                border-color: $white;
            }

            .kmx-search-form__submit-button {
                @include _kmx-search-form__submit-button--not-disabled;

                &:disabled {
                    background-color: $grey-300;
                    border-color: $grey-300;

                    .svg-icon {
                        color: $grey-500;
                    }
                }
            }
        }

        &--populated {
            .kmx-search-form__submit-button {
                @include _kmx-search-form__submit-button--not-disabled;
            }
        }
    }

    &__search-input {
        background-color: $white;
        border-bottom: 1px solid $grey-300;
        border-left: 1px solid $grey-300;
        border-right: none;
        border-top: 1px solid $grey-300;
        border-top-left-radius: size('xxs');
        border-bottom-left-radius: size('xxs');
        color: $kmx-blue-500;
        flex-grow: 1;
        font-family: $kmx-typography-font-alt;
        height: 36px;
        min-width: 0; // Fix for Firefox and Safari - https://css-tricks.com/flexbox-truncated-text/
        order: 0;
        outline: none;
        padding: 0 0 0 size('s');
        width: 100%;

        /**
         * For ::placeholder styling,
         * Firefox needs opacity set explicitly to 1
         * in order to override default browser styles
         */
        &::placeholder {
            color: $grey-600;
            opacity: 1;
        }

        &:focus::placeholder {
            color: $grey-400;
            opacity: 1;
        }

        /* stylelint-disable declaration-no-important */
        &:-ms-input-placeholder {
            color: $grey-600 !important; // IE 11 requires !important to override default browser styles
        }

        &:focus:-ms-input-placeholder {
            color: $grey-400 !important; // IE 11 requires !important to override default browser styles
        }
        /* stylelint-enable declaration-no-important */

        &::-ms-clear {
            display: none;
        }
    }

    &__clear-button,
    &__submit-button {
        background-color: $white;
        cursor: pointer;
        flex-shrink: 0;
        height: 36px;
        outline: none;
        transition: background-color 20ms linear;
        width: 36px;

        @include kmx-svg-base;
        @include kmx-svg-icon;

        .svg-icon {
            color: $grey-500;
            flex-shrink: 0;
            height: size('l');
            width: size('l');
        }
    }

    &__clear-button {
        border-bottom: 1px solid $grey-300;
        border-left: none;
        border-right: none;
        border-top: 1px solid $grey-300;
        display: none;
        order: 1;

        &.visible {
            display: block;
        }

        &:focus,
        &:hover {
            .svg-icon {
                color: $grey-700;
            }
        }
    }

    &__submit-button {
        border-bottom: 1px solid $grey-300;
        border-left: none;
        border-right: 1px solid $grey-300;
        border-top: 1px solid $grey-300;
        border-top-right-radius: size('xxs');
        border-bottom-right-radius: size('xxs');
        order: 2;

        &:disabled {
            cursor: not-allowed;
        }
    }
}
